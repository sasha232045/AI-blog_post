難易度: 4

## 主成分分析 (PCA)

主成分分析（Principal Component Analysis, PCA）は、**特徴抽出**の最も代表的な手法であり、教師なし学習に分類される**次元削減**アルゴリズムです。データのばらつき（分散）が最も大きくなる方向を見つけ出し、その方向を新しい軸（**主成分**）とすることで、元のデータの情報をできるだけ損なわずに、より低い次元で表現することを目指します。

### 主成分分析の考え方

PCAの核となるアイデアは、データに内在する「主要な変動の方向」を捉えることです。

1.  **第一主成分**: データの分散が最大になるような方向ベクトルを見つけます。これは、データが最も広がっている方向であり、最も多くの情報を含んでいると解釈できます。
2.  **第二主成分**: 第一主成分と直交する方向の中で、分散が最大になる方向を見つけます。
3.  **第三主成分以降**: 同様に、それまでに見つかった全ての主成分と直交する方向の中で、分散が最大になる方向を順次見つけていきます。

このようにして得られた主成分は、互いに相関のない（直交した）新しい特徴量となります。元の特徴量の数は、主成分の数と同じだけ得られます。

### 次元削減への応用

通常、最初のいくつかの主成分（例えば、第一主成分と第二主成分）だけで、データ全体の分散の大部分を説明することができます。各主成分がどれくらいの分散を説明しているかは、「**寄与率**」という指標で評価できます。

次元削減を行うには、寄与率の高い主成分をいくつか選び、それらを新しい特徴量として採用します。例えば、100次元のデータを2次元に削減したい場合、第一主成分と第二主成分を新しい特徴量とします。これにより、元のデータの情報を可能な限り保持したまま、次元を大幅に削減できます。

### PCAのステップ

1.  **標準化**: 各特徴量のスケールを揃えるため、平均が0、分散が1になるようにデータを標準化します。
2.  **共分散行列の計算**: 標準化されたデータから、特徴量間の相関関係を表す共分散行列を計算します。
3.  **固有値と固有ベクトルの計算**: 共分散行列の固有値と固有ベクトルを求めます。固有値は主成分の分散の大きさを、固有ベクトルは主成分の方向を表します。
4.  **主成分の選択**: 固有値の大きい順に主成分（固有ベクトル）を選びます。
5.  **データの変換**: 元のデータを、選ばれた主成分を新しい基底として射影し、新しい特徴量を得ます。

### 注意点

-   PCAは、あくまで分散が大きい方向を重視するため、その方向が必ずしもタスク（例: 分類）にとって重要であるとは限りません。クラスの分離を目的とする場合は、**線形判別分析（LDA）**のような教師ありの手法が適している場合があります。
-   特徴量のスケールに大きく影響されるため、事前に標準化などの前処理を行うことが非常に重要です。

*[特徴抽出]: 既存の特徴量を組み合わせて、より少ない数の新しい特徴量を作り出す手法。
*[次元削減]: データの持つ情報をできるだけ損なわずに、特徴量の数を減らすこと。
*[主成分]: データの分散が最大になる方向を示す、互いに直交する新しい軸。