難易度: 4

## 畳み込みニューラルネットワーク (CNN)

畳み込みニューラルネットワーク（Convolutional Neural Network, CNNまたはConvNet）は、特に画像認識の分野で絶大な成功を収めている**ディープラーニング**のモデルです。人間の視覚野の仕組みから着想を得ており、画像のような格子状のデータ構造から効率的に特徴を抽出することに特化しています。

### CNNの主な構成要素

従来の**ニューラルネットワーク**（全結合層）とは異なり、CNNは主に以下の2つの特殊な層を組み合わせて構成されます。

1.  **畳み込み層 (Convolutional Layer)**
    *   CNNの中核をなす層です。
    *   **フィルター（またはカーネル）**と呼ばれる小さな行列を用いて、入力画像の上をスライドさせながら**畳み込み演算**を行います。
    *   フィルターは、画像の中から特定の特徴（例えば、縦線、横線、特定の色、エッジなど）を検出する役割を持ちます。入力画像とフィルターの対応する要素を掛け合わせて合計することで、その領域がフィルターの検出したい特徴をどれだけ含んでいるかを示す**特徴マップ（Feature Map）**が生成されます。
    *   一つの畳み込み層で複数の異なるフィルターを用いることで、画像から多様な特徴を同時に抽出できます。

2.  **プーリング層 (Pooling Layer)**
    *   畳み込み層で得られた特徴マップのサイズを縮小（ダウンサンプリング）するための層です。
    *   特徴マップを小さな領域に分割し、各領域の代表値（例えば、最大値を取る**マックスプーリング**や、平均値を取る**アベレージプーリング**）を計算します。
    *   これにより、計算コストを削減すると同時に、画像内のわずかな位置のずれに対してモデルが頑健になる（位置不変性を持つ）という効果があります。

### CNNのアーキテクチャ

一般的なCNNは、「畳み込み層 → 活性化関数（**ReLU**など） → プーリング層」という一連の処理を何層か繰り返すことで、画像の局所的な特徴（エッジなど）から、より大域的で複雑な特徴（目、鼻、顔の輪郭など）へと、階層的に特徴を抽出していきます。

ネットワークの最終段では、抽出された特徴マップを1次元のベクトルに変換し、全結合層に入力して、最終的な分類（例:「この画像は猫である」「犬である」）などのタスクを行います。

### なぜ画像に強いのか？

-   **局所的な結合**: 全結合層とは異なり、畳み込み層のニューロンは入力画像のごく一部の領域（受容野）にしか接続していません。これにより、空間的な局所性を効率的に学習できます。
-   **パラメータの共有**: 一つのフィルターは、画像の全ての領域で共通して使用されます。これにより、学習すべき**重み**の数が劇的に削減され、効率的な学習が可能になります。

CNNの登場は、**AlexNet**が2012年の画像認識コンペティション**ILSVRC**で圧勝したことをきっかけに、ディープラーニングブームの火付け役となりました。

*[ディープラーニング]: 深い階層を持つニューラルネットワークを用いた機械学習の手法。
*[ニューラルネットワーク]: 脳の神経回路網を模した数理モデル。
*[畳み込み演算]: フィルターを入力データ上でスライドさせながら積和を計算する処理。
*[ReLU]: 入力が0以下なら0、0より大きければそのまま出力する活性化関数。
*[重み]: ニューロン間の接続の強さを示すパラメータ。
*[AlexNet]: 2012年に画像認識の世界に衝撃を与えたCNNモデル。
*[ILSVRC]: 大規模な画像認識の国際コンペティション。