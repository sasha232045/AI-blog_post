難易度: 3

## 階層的クラスタリング

階層的クラスタリングは、データセットを階層的な構造（樹形図やデンドログラムと呼ばれる）で表現するクラスタリング手法です。この手法の大きな特徴は、**k-means法**のように事前にクラスター数を指定する必要がない点です。

### 階層的クラスタリングの種類

階層的クラスタリングには、大きく分けて2つのアプローチがあります。

1.  **凝集型（ボトムアップ・アプローチ）**:
    *   最初に各データ点をそれぞれ独立したクラスターとみなし、最も似ている（距離が近い）クラスター同士を順次併合していく方法です。最終的に、全てのデータが単一の巨大なクラスターにまとめられるまで続きます。
    *   これは最も一般的に用いられるアプローチです。

2.  **分割型（トップダウン・アプローチ）**:
    *   最初に全てのデータ点を一つのクラスターとみなし、最も似ていない（距離が遠い）データを含むクラスターを順次分割していく方法です。最終的に、各データ点がそれぞれ独立したクラスターになるまで続きます。

### クラスター間の距離（類似度）

凝集型クラスタリングでは、どのクラスター同士を併合するかを決定するために、クラスター間の距離を定義する必要があります。代表的な手法には以下のようなものがあります。

-   **ウォード法**: クラスターを併合した際に、クラスター内の平方和がどれだけ増加するかを基準にします。この増加量が最小となるクラスター同士を併合します。比較的小さく、密なクラスターを形成する傾向があります。
-   **単連結法（最短距離法）**: 2つのクラスター間で、最も距離が近いデータ点同士の距離をクラスター間の距離とします。
-   **完全連結法（最長距離法）**: 2つのクラスター間で、最も距離が遠いデータ点同士の距離をクラスター間の距離とします。
-   **群平均法**: 2つのクラスターに含まれる全てのデータ点のペアの距離の平均をクラスター間の距離とします。

### デンドログラム

階層的クラスタリングの結果は、**デンドログラム**（樹形図）と呼ばれる図で可視化されます。デンドログラムを見ることで、データがどのようにグループ化されていくかの過程を視覚的に理解することができます。また、デンドログラムを任意の高さで水平に切断することで、その高さに応じた数のクラスターを得ることができます。

### 特徴

- **長所**:
    - クラスター数を事前に指定する必要がない。
    - デンドログラムにより、データの階層構造を可視化できる。

- **短所**:
    - 計算量が大きく、大規模なデータセットには向かない場合がある。
    - 一度クラスターが形成されると、その後のステップで変更されないため、初期の併合や分割の誤りが後々まで影響する可能性がある。

*[クラスタリング]: データセットを類似性に基づいていくつかのグループ（クラスター）に分割するタスク。
*[k-means法]: データセットを、あらかじめ指定されたk個のクラスターに分割するアルゴリズム。